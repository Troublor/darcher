{"version":3,"sources":["webpack://@darcher/misc/../node_modules/ws/browser.js","webpack://@darcher/misc/../darcher-helpers-browser/dist/index.js","webpack://@darcher/misc/../darcher-helpers-browser/dist/log.js","webpack://@darcher/misc/../darcher-helpers-browser/dist/utility.js","webpack://@darcher/misc/./src/trace-instrument.ts","webpack://@darcher/misc/webpack/bootstrap","webpack://@darcher/misc/webpack/startup","webpack://@darcher/misc/webpack/runtime/global"],"names":["module","exports","Error","__createBinding","this","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__exportStar","p","prototype","hasOwnProperty","call","value","Logger","level","parseLog","message","context","_a","now","Date","logTime","getMonth","toString","padStart","getDay","getHours","getMinutes","getSeconds","getMilliseconds","padEnd","slice","colored","payload","contextLiteral","key","Level","levelString","log","ERROR","console","error","WARN","warn","INFO","info","DEBUG","debug","lvl","prettifyHash","hash","startIndex","startsWith","substring","length","isBrowser","GLOBAL","logger","oneTimeWebSocketRequest","url","data","Promise","resolve","reject","ws","WebSocket","onopen","send","JSON","stringify","onerror","ev","onmessage","msg","parse","close","type","stack","window","g","traceSendAsync","method","params","callback","traceCache","includes","captureStackTrace","Proxy","apply","target","thisArg","argArray","gas","split","map","item","trim","filter","traceHistories","push","i","from","to","result","err","on","e","traceObj","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","globalThis","Function"],"mappings":"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","file":"trace-instrument.web.js","sourcesContent":["'use strict';\n\nmodule.exports = function () {\n  throw new Error(\n    'ws does not work in the browser. Browser clients must use the native ' +\n      'WebSocket object'\n  );\n};\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./log\"), exports);\n__exportStar(require(\"./utility\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Logger = void 0;\nvar Logger = /** @class */ (function () {\n    function Logger(module, level) {\n        this.module = module;\n        this.level = level;\n    }\n    Logger.prototype.parseLog = function (level, message, context) {\n        var _a;\n        var now = new Date();\n        var month = now.getMonth().toString().padStart(2, \"0\");\n        var day = now.getDay().toString().padStart(2, \"0\");\n        var hour = now.getHours().toString().padStart(2, \"0\");\n        var minute = now.getMinutes().toString().padStart(2, \"0\");\n        var second = now.getSeconds().toString().padStart(2, \"0\");\n        var millisecond = now.getMilliseconds().toString().padEnd(3, \"0\").slice(0, 3);\n        var logTime = month + \"-\" + day + \"|\" + hour + \":\" + minute + \":\" + second + \".\" + millisecond;\n        var colored = function (level, payload) {\n            // TODO coloring in Browser Console\n            return payload;\n        };\n        var contextLiteral = \"\";\n        if (context) {\n            for (var key in context) {\n                if (context.hasOwnProperty(key)) {\n                    // @ts-ignore\n                    contextLiteral += colored(level, key) + \"=\" + ((_a = context[key]) === null || _a === void 0 ? void 0 : _a.toString()) + \" \";\n                }\n            }\n        }\n        return colored(level, Logger.Level.levelString(level).padEnd(5, \" \")) + \"[\" + logTime + \"][\" + this.module + \"] \" + message.toString().padEnd(48, \" \") + \" \" + contextLiteral;\n    };\n    Logger.prototype.log = function (level, message, context) {\n        if (this.level <= level) {\n            switch (this.level) {\n                case Logger.Level.ERROR:\n                    console.error(this.parseLog(level, message, context));\n                    break;\n                case Logger.Level.WARN:\n                    console.warn(this.parseLog(level, message, context));\n                    break;\n                case Logger.Level.INFO:\n                    console.info(this.parseLog(level, message, context));\n                    break;\n                case Logger.Level.DEBUG:\n                    console.debug(this.parseLog(level, message, context));\n                    break;\n                default:\n                    console.log(this.parseLog(level, message, context));\n            }\n        }\n    };\n    Logger.prototype.info = function (message, context) {\n        this.log(Logger.Level.INFO, message, context);\n    };\n    Logger.prototype.warn = function (message, context) {\n        this.log(Logger.Level.WARN, message, context);\n    };\n    Logger.prototype.debug = function (message, context) {\n        this.log(Logger.Level.DEBUG, message, context);\n    };\n    Logger.prototype.error = function (message, context) {\n        this.log(Logger.Level.ERROR, message, context);\n    };\n    Logger.Level = {\n        DEBUG: 1,\n        INFO: 2,\n        WARN: 3,\n        ERROR: 4,\n        levelString: function (lvl) {\n            switch (lvl) {\n                case 1:\n                    return 'DEBUG';\n                case 2:\n                    return 'INFO';\n                case 3:\n                    return 'WARN';\n                case 4:\n                    return 'ERROR';\n                default:\n                    return 'UNKNOWN';\n            }\n        }\n    };\n    return Logger;\n}());\nexports.Logger = Logger;\n//# sourceMappingURL=log.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.prettifyHash = void 0;\nfunction prettifyHash(hash) {\n    var startIndex = 0;\n    if (hash.startsWith(\"0x\")) {\n        startIndex = 2;\n    }\n    return hash.substring(startIndex, startIndex + 6) + \"\\u2026\" + hash.substring(hash.length - 6, hash.length);\n}\nexports.prettifyHash = prettifyHash;\n//# sourceMappingURL=utility.js.map","import {Logger, prettifyHash} from \"@darcher/helpers-browser\";\nimport {Data} from \"./metamask-notifier\";\n\nexport interface SendTransactionTrace {\n    hash: string,\n    stack: string[],\n}\n\nexport interface StackTraceMessage extends Data {\n    type: 'FetchStackTrace',\n    stack: string[],\n}\n\nconst logger = new Logger(\"Trace\", Logger.Level.INFO);\n\nasync function oneTimeWebSocketRequest<T extends Data>(url: string, data: T): Promise<T> {\n    return new Promise<T>((resolve, reject) => {\n        const ws = new WebSocket(url);\n        ws.onopen = () => {\n            // send request\n            ws.send(JSON.stringify(data));\n        };\n        ws.onerror = (ev: ErrorEvent) => {\n            reject(ev);\n        }\n        ws.onmessage = (ev) => {\n            const msg = JSON.parse(ev.data) as T;\n            resolve(msg);\n            ws.close();\n        }\n    });\n}\n\nexport async function getStackTraceByCrawljax(): Promise<string[]> {\n    const resp = await oneTimeWebSocketRequest(\"ws://localhost:1237\", {\n        type: \"FetchStackTrace\",\n        stack: [],\n    } as StackTraceMessage);\n    return resp.stack;\n}\n\nexport interface TraceHistory {\n    method: string,\n    params: any[],\n    stack: string[] | null,\n}\n\ndeclare global {\n    interface Window {\n        traceHistories: TraceHistory[];\n    }\n}\n\nlet isBrowser;\nlet GLOBAL;\nif (typeof window !== 'undefined') {\n    GLOBAL = window;\n    isBrowser = true;\n} else if (typeof global !== \"undefined\") {\n    GLOBAL = global;\n    isBrowser = false;\n} else {\n    throw new Error(\"Failed to load trace-instrument\");\n}\n\nif (typeof GLOBAL !== 'undefined' && !GLOBAL.traceHistories) {\n    GLOBAL.traceHistories = [] as TraceHistory[];\n}\n\n\nexport function traceSendAsync(method: string, params: any[], callback: Function): Function {\n    const traceCache: TraceHistory = {\n        method: method,\n        params: params,\n        stack: null,\n    };\n    if (['eth_sendTransaction', 'eth_sendRawTransaction', 'eth_estimateGas'].includes(method)) {\n        const traceObj = {stack: undefined};\n        Error.captureStackTrace(traceObj, traceSendAsync);\n        callback = new Proxy(callback, {\n            apply(target, thisArg, argArray) {\n                if (method === 'eth_estimateGas') {\n                    // save gas\n                    traceCache.params[0].gas = argArray[1];\n                    // save to history, in case there is a transaction use this call later\n                    traceCache.stack = traceObj.stack.split(/\\n/).map(item => item.trim()).filter(item => item.length > 0 && item !== \"Error\");\n                    GLOBAL.traceHistories.push(traceCache);\n                } else if (['eth_sendTransaction', 'eth_sendRawTransaction'].includes(method)) {\n                    // search trace history for a possible estimateGas cache (which is more precise)\n                    for (let i = GLOBAL.traceHistories.length - 1; i >= 0; i--) {\n                        const history = GLOBAL.traceHistories[i];\n                        if (history.method === 'eth_estimateGas' &&\n                            history.params[0] && params[0] &&\n                            history.params[0].from === params[0].from &&\n                            history.params[0].to === params[0].to &&\n                            history.params[0].data === params[0].data\n                        ) {\n                            // delete this from history\n                            GLOBAL.traceHistories = GLOBAL.traceHistories.filter(value => value !== history);\n                            // use the stack trace of this cache\n                            traceCache.stack = history.stack;\n                            break;\n                        }\n                    }\n                    if (!traceCache.stack) {\n                        // no history found, use current one\n                        traceCache.stack = traceObj.stack.split(/\\n/).map(item => item.trim()).filter(item => item.length > 0 && item !== \"Error\");\n                    }\n                    // send trace to server\n                    const trace = {\n                        hash: typeof argArray[1] === \"string\" ? argArray[1] : argArray[1].result,\n                        stack: traceCache.stack,\n                    } as SendTransactionTrace;\n                    logger.info(\"Transaction trace\", {hash: trace.hash, stack: trace.stack})\n                    if (isBrowser) {\n                        const ws = new WebSocket(`ws://localhost:1236`);\n                        ws.onopen = () => {\n                            ws.send(JSON.stringify(trace));\n                        };\n                        ws.onerror = (ev: ErrorEvent) => {\n                            logger.error(\"Send transaction trace error\", {err: ev});\n                        }\n                        ws.onmessage = () => {\n                            ws.close();\n                        }\n                    } else {\n                        const WebSocket = require(\"ws\");\n                        const ws = new WebSocket(\"ws://localhost:1236\");\n                        ws.on('open', () => {\n                            ws.send(JSON.stringify(trace));\n                        });\n                        ws.on(\"error\", e => {\n                            logger.error(\"Send transaction trace error\", {err: e});\n                        });\n                        ws.on(\"message\", () => {\n                            ws.close();\n                        });\n                    }\n\n                }\n                target.apply(thisArg, argArray);\n            },\n        });\n    }\n    return callback;\n}\n\nexport function traceSend(method: string, result: string) {\n    if ((method === 'eth_sendTransaction' || method === 'eth_sendRawTransaction')) {\n        const traceObj = {stack: undefined};\n        Error.captureStackTrace(traceObj, traceSendAsync);\n        const trace = {\n            hash: result,\n            stack: traceObj.stack.split(/\\n/).map(item => item.trim()).filter(item => item.length > 0 && item !== \"Error\"),\n        } as SendTransactionTrace;\n        logger.info(\"Transaction trace\", {hash: prettifyHash(trace.hash), stack: trace.stack});\n        const ws = new WebSocket(`ws://localhost:1236`);\n        ws.onopen = () => {\n            ws.send(JSON.stringify(trace));\n        };\n        ws.onerror = (ev: ErrorEvent) => {\n            logger.error(\"Send transaction trace error\", {err: ev});\n        }\n        ws.onmessage = () => {\n            ws.close();\n        }\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(846);\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();"],"sourceRoot":""}